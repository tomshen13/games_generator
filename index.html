<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Kids Games ğŸ®</title>
  <link rel="stylesheet" href="shared/css/reset.css">
  <link rel="stylesheet" href="shared/css/base.css">
  <link rel="stylesheet" href="shared/css/animations.css">
  <link rel="stylesheet" href="shared/css/components.css">
  <link rel="stylesheet" href="shared/css/profile.css">
  <link rel="stylesheet" href="shared/css/dashboard.css">
  <style>
    html, body {
      overflow: auto;
      height: auto;
      min-height: 100%;
    }

    .launcher {
      min-height: 100%;
      background: linear-gradient(135deg, #1a0a2e, #16213e, #1a0a2e);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: var(--space-xl) var(--space-lg);
      overflow-y: auto;
    }

    .launcher-title {
      font-size: var(--text-2xl);
      text-align: center;
      margin-bottom: var(--space-xs);
    }

    .launcher-subtitle {
      font-size: var(--text-md);
      color: var(--color-text-muted);
      text-align: center;
      margin-bottom: var(--space-lg);
    }

    .game-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
      gap: var(--space-xl);
      max-width: 900px;
      width: 100%;
    }

    .game-card {
      text-align: center;
      padding: var(--space-xl);
      transition: all var(--duration-normal) var(--ease-bounce);
    }

    .game-card:hover {
      transform: translateY(-6px) scale(1.02);
    }

    .game-card-icon {
      font-size: clamp(60px, 12vw, 80px);
      margin-bottom: var(--space-md);
      display: block;
    }

    .game-card-title {
      font-family: var(--font-display);
      font-size: var(--text-lg);
      margin-bottom: var(--space-xs);
    }

    .game-card-ages {
      font-size: var(--text-sm);
      color: var(--color-text-muted);
      margin-bottom: var(--space-md);
    }

    .game-card-desc {
      font-size: var(--text-sm);
      color: var(--color-text-muted);
      margin-bottom: var(--space-lg);
      line-height: 1.5;
    }

    .game-card.coming-soon {
      opacity: 0.5;
      pointer-events: none;
    }

    .game-card.coming-soon .game-card-icon {
      filter: grayscale(1);
    }

    .coming-soon-badge {
      display: inline-block;
      padding: var(--space-xs) var(--space-md);
      background: rgba(255, 255, 255, 0.1);
      border-radius: var(--radius-md);
      font-size: var(--text-xs);
      color: var(--color-text-muted);
    }
  </style>
</head>
<body>
  <!-- ===== Profile Selector Screen ===== -->
  <div class="launcher profile-screen active" id="profileScreen"
       style="background: linear-gradient(135deg, #1a0a2e, #16213e, #1a0a2e);">
    <h1 class="profile-title">ğŸ® Kids Games</h1>
    <p class="profile-subtitle">Who's playing?</p>
    <div class="profile-cards">
      <button class="card profile-card animate-fade-up" data-profile="Dan" style="animation-delay: 100ms">
        <span class="profile-avatar">ğŸ‘¦</span>
        <span class="profile-name">Dan</span>
      </button>
      <button class="card profile-card animate-fade-up" data-profile="Emma" style="animation-delay: 200ms">
        <span class="profile-avatar">ğŸ‘§</span>
        <span class="profile-name">Emma</span>
      </button>
    </div>
  </div>

  <!-- ===== Game Launcher ===== -->
  <div class="launcher" id="launcherScreen" style="display: none;">
    <h1 class="launcher-title">ğŸ® Kids Games</h1>
    <p class="launcher-subtitle">Fun learning adventures for ages 4â€“7!</p>
    <div class="launcher-header">
      <div class="profile-badge" id="profileBadge">
        <span class="profile-badge-initial" id="badgeInitial"></span>
        <span id="badgeName"></span>
      </div>
      <button class="btn-switch-player" id="btnSwitchPlayer">Switch Player</button>
    </div>
    <div class="game-grid" id="gameGrid"></div>
    <button class="btn-dashboard" id="btnDashboard">ğŸ”’ Parent Dashboard</button>
  </div>

  <!-- ===== Parent Dashboard Screen ===== -->
  <div class="dashboard-screen" id="dashboardScreen"
       style="background: linear-gradient(135deg, #1a0a2e, #16213e, #1a0a2e);">
    <div class="dashboard-header">
      <button class="btn-dashboard-back" id="btnDashboardBack">â†</button>
      <h2 class="dashboard-title">Parent Dashboard</h2>
    </div>
    <div class="dashboard-tabs">
      <button class="dashboard-tab active" data-profile="Dan">ğŸ‘¦ Dan</button>
      <button class="dashboard-tab" data-profile="Emma">ğŸ‘§ Emma</button>
    </div>
    <div class="dashboard-content"></div>
  </div>

  <!-- ===== PIN Pad Modal ===== -->
  <div class="pin-overlay" id="pinOverlay" hidden>
    <div class="pin-modal">
      <h3>Enter Parent PIN</h3>
      <div class="pin-dots">
        <span class="pin-dot"></span>
        <span class="pin-dot"></span>
        <span class="pin-dot"></span>
        <span class="pin-dot"></span>
      </div>
      <div class="pin-error"></div>
      <div class="pin-numpad">
        <button class="pin-key" data-val="1">1</button>
        <button class="pin-key" data-val="2">2</button>
        <button class="pin-key" data-val="3">3</button>
        <button class="pin-key" data-val="4">4</button>
        <button class="pin-key" data-val="5">5</button>
        <button class="pin-key" data-val="6">6</button>
        <button class="pin-key" data-val="7">7</button>
        <button class="pin-key" data-val="8">8</button>
        <button class="pin-key" data-val="9">9</button>
        <button class="pin-key pin-key-back" data-val="back">âŒ«</button>
        <button class="pin-key" data-val="0">0</button>
        <button class="pin-key pin-key-back" data-val="back">âœ•</button>
      </div>
      <button class="pin-cancel">Cancel</button>
    </div>
  </div>

  <!-- Shared JS -->
  <script src="shared/js/storage.js"></script>
  <script src="shared/js/supabase-sync.js"></script>
  <script src="shared/js/profile.js"></script>
  <script src="shared/js/parent-dashboard.js"></script>

  <script>
    const GAMES = [
      {
        id: 'unicorn-numbers',
        title: 'Unicorn Numbers',
        icon: 'ğŸ¦„',
        ages: 'Ages 4+',
        description: 'Learn numbers 1â€“20 with fire and water powers!',
        path: 'games/unicorn-numbers/index.html',
        available: true,
      },
      {
        id: 'pokemon-multiply',
        title: 'Pokemon Multiply',
        icon: 'âš¡',
        ages: 'Ages 6+',
        description: 'Master multiplication with Pokemon battles!',
        path: 'games/pokemon-multiply/index.html',
        available: true,
      },
      {
        id: 'mario-bros',
        title: 'Super Mario Bros',
        icon: 'ğŸ„',
        ages: 'Ages 6+',
        description: 'A classic platformer adventure with Mario & Luigi!',
        path: 'games/mario-bros/index.html',
        available: true,
      },
      {
        id: 'shape-explorer',
        title: 'Shape Explorer',
        icon: 'ğŸ”·',
        ages: 'Ages 4â€“5',
        description: 'Discover circles, squares, triangles and more!',
        path: null,
        available: false,
      },
      {
        id: 'letter-safari',
        title: 'Letter Safari',
        icon: 'ğŸ¦',
        ages: 'Ages 5â€“6',
        description: 'Go on an alphabet adventure through the jungle!',
        path: null,
        available: false,
      },
      {
        id: 'color-mixing',
        title: 'Color Mixing Lab',
        icon: 'ğŸ¨',
        ages: 'Ages 4â€“7',
        description: 'Mix colors and create amazing art!',
        path: null,
        available: false,
      },
    ];

    function renderGames() {
      const grid = document.getElementById('gameGrid');
      grid.innerHTML = '';
      GAMES.forEach((game, i) => {
        const card = document.createElement('div');
        card.className = `card game-card ${game.available ? '' : 'coming-soon'}`;
        card.style.animationDelay = `${i * 100}ms`;
        card.classList.add('animate-fade-up');

        if (game.available) {
          card.innerHTML = `
            <span class="game-card-icon">${game.icon}</span>
            <h2 class="game-card-title">${game.title}</h2>
            <p class="game-card-ages">${game.ages}</p>
            <p class="game-card-desc">${game.description}</p>
            <a class="btn btn-primary" href="${game.path}">â–¶ PLAY</a>
          `;
        } else {
          card.innerHTML = `
            <span class="game-card-icon">ğŸ”’</span>
            <h2 class="game-card-title">${game.title}</h2>
            <p class="game-card-ages">${game.ages}</p>
            <p class="game-card-desc">${game.description}</p>
            <span class="coming-soon-badge">Coming Soon</span>
          `;
        }

        grid.appendChild(card);
      });
    }

    function showLauncher(profileName) {
      document.getElementById('profileScreen').style.display = 'none';
      const launcher = document.getElementById('launcherScreen');
      launcher.style.display = '';

      // Update badge
      const initial = document.getElementById('badgeInitial');
      initial.textContent = profileName[0];
      initial.dataset.profile = profileName;
      document.getElementById('badgeName').textContent = profileName;

      renderGames();
    }

    function showProfileScreen() {
      document.getElementById('launcherScreen').style.display = 'none';
      document.getElementById('dashboardScreen').classList.remove('active');
      document.getElementById('profileScreen').style.display = '';
    }

    // Profile card clicks
    document.querySelectorAll('.profile-card').forEach(card => {
      card.addEventListener('click', async () => {
        const name = card.dataset.profile;
        await Profile.selectProfile(name);
        showLauncher(name);
      });
    });

    // Switch player
    document.getElementById('btnSwitchPlayer').addEventListener('click', showProfileScreen);

    // Dashboard
    document.getElementById('btnDashboard').addEventListener('click', () => Dashboard.open());
    document.getElementById('btnDashboardBack').addEventListener('click', () => Dashboard.hide());

    // Auto-resume if profile already set
    const savedProfile = Storage.getProfile();
    if (savedProfile) {
      showLauncher(savedProfile);
    }
  </script>
</body>
</html>
