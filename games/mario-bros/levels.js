/**
 * Level data â€” 5 levels with tilemaps and entity spawns.
 * Tiles: .=air G=ground U=underground B=brick ?=question Q=question_power
 *        P=pipe_top p=pipe_body -=platform I=ice L=lava C=castle F=flag
 * Maps are 14 rows tall.
 */
const LEVELS = (() => {

  const CHAR_TO_TILE = {
    '.': 0, 'G': 1, 'B': 2, '?': 3, 'Q': 4,
    'P': 5, 'p': 7, '-': 9, 'I': 10, 'L': 11,
    'C': 12, 'F': 14, 'g': 15,
  };

  function parseMap(str) {
    const rows = str.trim().split('\n').map(r => r.trimEnd());
    const height = rows.length;
    const width = Math.max(...rows.map(r => r.length));
    const tiles = [];
    for (let r = 0; r < height; r++) {
      const row = [];
      for (let c = 0; c < width; c++) {
        const ch = (rows[r] || '')[c] || '.';
        row.push(CHAR_TO_TILE[ch] || 0);
      }
      tiles.push(row);
    }
    return { tiles, width, height };
  }

  // ===== LEVEL 1: GREEN HILLS =====
  const L1 = parseMap(
`..............................................................................................................................................................................................................
..............................................................................................................................................................................................................
..............................................................................................................................................................................................................
..............................................................................................................................................................................................................
....................?...............................................?Q?..................................................?.......................................................
..............................................................................................................................................................................................................
.........................B.B.B...........................................................B.B.B.B..........................................................................B.B.B..
..............................................................................................................................................................................................................
..............................................................................................................................................................................................................
...............................................................-.-.-.-.........................................................................-.-.-.-.-.........................
..............................................................................................................................................................................................................
..............PP........................................................PP..............................PP........................................................PP..........F.
GGGGGGGGGGGGGPPGGGGG...GGGGGGGGGGGGGGGGGGGGG...GGGGGGGGGGGGGGGGGGGGGGGPPGGGGGGGGGGG...GGGGGGGGGGGGGGGGPPGGGGGGGGGG...GGGGGGGGGGGGGGGGGGGGG...GGGGGGGGGGGGGGPPGGGGGGGGGGGGGGGGGG
gggggggggggggggggggg...ggggggggggggggggggggg...ggggggggggggggggggggggggggggggggggggg...gggggggggggggggggggggggggggg...ggggggggggggggggggggg...ggggggggggggggggggggggggggggggggggg`);

  // ===== LEVEL 2: UNDERGROUND CAVE =====
  const L2 = parseMap(
`BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB
BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB
..............................................................................................................................................................................................................
..............................................................................................................................................................................................................
................?..............................................Q..?..............................................................................?.............................
..............................................................................................................................................................................................................
.......................BB.BB.BB...............BB.BB..........................................................BB.BB.BB.BB...............BB.BB....................................
..............................................................................................................................................................................................................
..............................................................................................................................................................................................................
....................................................................-.-.-.-.-.-.............................................-.-.-.-.-.-.-.......................................
..............................................................................................................................................................................................................
..............PP........................................................PP..............................PP........................................................PP..........F.
GGGGGGGGGGGGGPPGGGGGG..GGGGGGGGGGGGGGGGGGGG..GGGGGGGGGGGGGGGGGGGGGGGGGPPGGGGGGGGGGG..GGGGGGGGGGGGGGGGGPPGGGGGGGGGGG..GGGGGGGGGGGGGGGGGG..GGGGGGGGGGGGGGGGGPPGGGGGGGGGGGGGGGGGG
gggggggggggggggggggg...ggggggggggggggggggggg..ggggggggggggggggggggggggggggggggggggg...ggggggggggggggggggggggggggggg...ggggggggggggggggggg..ggggggggggggggggggggggggggggggggggggg`);

  // ===== LEVEL 3: SKY WORLD =====
  const L3 = parseMap(
`..............................................................................................................................................................................................................
..............................................................................................................................................................................................................
..............................................................................................................................................................................................................
..............................................................................................................................................................................................................
.................?.........................................................Q..?...............................................................?.............................
..............................................................................................................................................................................................................
..............................................................................................................................................................................................................
........-.-.-...........-.-...........-.-.-.-...........-.-...........-.-.-...........-.-.-...........-.-...........-.-.-.-...........-.-...........-.-.-...............-.-.
..............................................................................................................................................................................................................
..............................................................................................................................................................................................................
...-.-...........-.-.-...........-.-...........-.-.-...........-.-...........-.-.-...........-.-...........-.-.-...........-.-...........-.-.-...........-.-..............-.
..............................................................................................................................................................................................................
..........................................................................................................................-.-.-.........-.-.........-.-..........-.-.F.
GGGGG...............................................................................................................................................................................................................GGGGG`);

  // ===== LEVEL 4: ICE CASTLE =====
  const L4 = parseMap(
`CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
..............................................................................................................................................................................................................
..............................................................................................................................................................................................................
................?...........................................................Q..?...............................................................?.............................
..............................................................................................................................................................................................................
....................II.II.II.........................II.II.............................................II.II.II.II.........................II.II....................................
..............................................................................................................................................................................................................
..............................................................................................................................................................................................................
....................................................................-.-.-.-.-.-.............................................-.-.-.-.-.-.-.......................................
..............................................................................................................................................................................................................
...............................................................................................................................................................................................................F.
IIIIIIIIIIIIIIIIIIIIII..IIIIIIIIIIIIIIIIIIIII..IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII..IIIIIIIIIIIIIIIIIIIIIIIIIIIIII..IIIIIIIIIIIIIIIIIIIII..IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII
gggggggggggggggggggg...ggggggggggggggggggggg..gggggggggggggggggggggggggggggggggggg....ggggggggggggggggggggggggggggg..ggggggggggggggggggggg..ggggggggggggggggggggggggggggggggggggggggggg`);

  // ===== LEVEL 5: BOWSER'S FORTRESS =====
  const L5 = parseMap(
`CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
....................................................................................................................................................................................................................
....................................................................................................................................................................................................................
................?.............................................................................Q..?...............................................................................?..
....................................................................................................................................................................................................................
....................BB.BB.BB.............................BB.BB............................................................BB.BB.BB.BB.............................BB.BB........
....................................................................................................................................................................................................................
....................................................................................................................................................................................................................
........................................................................-.-.-.-.-.-.-.............................................-.-.-.-.-.-.-.-.................................
....................................................................................................................................................................................................................
...................................................................................................................................................................................................................F.
CCCCCCCCCCCCCCCCCCCCC..CCCCCCCCCCLLLLCCCCCCC..CCCCCCCCCCCCCCCCCLLLLCCCCCCCCCCCCCCC..CCCCCCCCCCCCCCCCCCCCCCCCCCCCCC..CCCCCCCCCCCLLLLCCCCCC..CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
gggggggggggggggggggg...ggggggggggLLLLggggggg..ggggggggggggggggLLLLggggggggggggggg...gggggggggggggggggggggggggggggg..gggggggggggLLLLgggggg..ggggggggggggggggggggggggggggggggggggggggggggg`);

  // ===== ENTITY DEFINITIONS =====

  function buildLevel(parsed, meta) {
    return {
      ...parsed,
      ...meta,
    };
  }

  return [
    buildLevel(L1, {
      id: 1,
      name: 'Green Hills',
      powerUp: 'ice',
      bgColor: '#5C94FC',
      bgLayers: ['hills', 'bushes'],
      entities: [
        { type: 'spawn', x: 3, y: 11 },
        { type: 'goomba', x: 25, y: 11 },
        { type: 'goomba', x: 40, y: 11 },
        { type: 'coin', x: 20, y: 3 },
        { type: 'coin_row', x: 50, y: 7, count: 5 },
        { type: 'goomba', x: 65, y: 11 },
        { type: 'coin_row', x: 75, y: 3, count: 3 },
        { type: 'goomba', x: 85, y: 11 },
        { type: 'goomba', x: 90, y: 11 },
        { type: 'coin_row', x: 100, y: 8, count: 4 },
        { type: 'goomba', x: 115, y: 11 },
        { type: 'coin_row', x: 125, y: 5, count: 3 },
        { type: 'goomba', x: 135, y: 11 },
        { type: 'coin', x: 145, y: 7 },
        { type: 'coin', x: 146, y: 7 },
      ],
    }),

    buildLevel(L2, {
      id: 2,
      name: 'Underground Cave',
      powerUp: 'fire',
      bgColor: '#000000',
      bgLayers: ['cave_ceiling', 'stalactites'],
      entities: [
        { type: 'spawn', x: 3, y: 11 },
        { type: 'goomba', x: 22, y: 11 },
        { type: 'goomba', x: 28, y: 11 },
        { type: 'coin_row', x: 35, y: 3, count: 4 },
        { type: 'goomba', x: 50, y: 11 },
        { type: 'goomba', x: 55, y: 11 },
        { type: 'coin_row', x: 65, y: 8, count: 5 },
        { type: 'goomba', x: 80, y: 11 },
        { type: 'goomba', x: 85, y: 11 },
        { type: 'goomba', x: 90, y: 11 },
        { type: 'coin_row', x: 100, y: 5, count: 3 },
        { type: 'coin_row', x: 110, y: 8, count: 4 },
        { type: 'goomba', x: 120, y: 11 },
        { type: 'goomba', x: 130, y: 11 },
        { type: 'coin', x: 140, y: 4 },
      ],
    }),

    buildLevel(L3, {
      id: 3,
      name: 'Sky World',
      powerUp: 'wings',
      bgColor: '#87CEEB',
      bgLayers: ['clouds_far', 'clouds_near'],
      entities: [
        { type: 'spawn', x: 1, y: 12 },
        { type: 'coin_row', x: 10, y: 6, count: 3 },
        { type: 'koopa_fly', x: 20, y: 5 },
        { type: 'coin_row', x: 30, y: 6, count: 3 },
        { type: 'koopa_fly', x: 45, y: 4 },
        { type: 'coin_row', x: 55, y: 9, count: 4 },
        { type: 'koopa_fly', x: 70, y: 6 },
        { type: 'coin_row', x: 80, y: 6, count: 3 },
        { type: 'koopa_fly', x: 95, y: 3 },
        { type: 'coin_row', x: 105, y: 9, count: 5 },
        { type: 'koopa_fly', x: 120, y: 5 },
        { type: 'coin_row', x: 130, y: 6, count: 3 },
        { type: 'koopa_fly', x: 140, y: 4 },
        { type: 'coin', x: 150, y: 6 },
      ],
    }),

    buildLevel(L4, {
      id: 4,
      name: 'Ice Castle',
      powerUp: 'star',
      bgColor: '#1A1A3E',
      bgLayers: ['snowflakes'],
      entities: [
        { type: 'spawn', x: 3, y: 11 },
        { type: 'goomba', x: 22, y: 11 },
        { type: 'goomba', x: 30, y: 11 },
        { type: 'coin_row', x: 40, y: 3, count: 3 },
        { type: 'goomba', x: 55, y: 11 },
        { type: 'koopa_fly', x: 65, y: 5 },
        { type: 'coin_row', x: 75, y: 8, count: 4 },
        { type: 'goomba', x: 90, y: 11 },
        { type: 'goomba', x: 95, y: 11 },
        { type: 'koopa_fly', x: 105, y: 4 },
        { type: 'coin_row', x: 115, y: 5, count: 3 },
        { type: 'goomba', x: 125, y: 11 },
        { type: 'goomba', x: 135, y: 11 },
        { type: 'coin', x: 145, y: 4 },
      ],
    }),

    buildLevel(L5, {
      id: 5,
      name: "Bowser's Fortress",
      powerUp: 'mushroom',
      bgColor: '#1A0000',
      bgLayers: ['lava_glow'],
      entities: [
        { type: 'spawn', x: 3, y: 11 },
        { type: 'goomba', x: 22, y: 11 },
        { type: 'goomba', x: 25, y: 11 },
        { type: 'goomba', x: 35, y: 11 },
        { type: 'coin_row', x: 45, y: 3, count: 3 },
        { type: 'koopa_fly', x: 55, y: 5 },
        { type: 'goomba', x: 65, y: 11 },
        { type: 'goomba', x: 70, y: 11 },
        { type: 'coin_row', x: 80, y: 8, count: 5 },
        { type: 'koopa_fly', x: 90, y: 4 },
        { type: 'goomba', x: 100, y: 11 },
        { type: 'goomba', x: 105, y: 11 },
        { type: 'goomba', x: 110, y: 11 },
        { type: 'koopa_fly', x: 120, y: 5 },
        { type: 'coin_row', x: 130, y: 5, count: 4 },
        { type: 'goomba', x: 140, y: 11 },
        { type: 'goomba', x: 145, y: 11 },
        { type: 'koopa_fly', x: 155, y: 4 },
        { type: 'coin', x: 160, y: 4 },
      ],
    }),
  ];
})();
